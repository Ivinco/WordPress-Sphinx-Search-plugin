<?php
/*
	Copyright 2008  &copy; Percona Ltd  (email : office@percona.com)

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/
?>	
<style>
<!--
td.admioptions{
text-align:left;
}
-->
</style>
<div class=wrap>
		<form method="post" action="<?php echo $_SERVER["REQUEST_URI"]; ?>">
		<h2>Sphinx Search</h2>
		<fieldset class="options">
			<h3>Search in</h3>
			<table class="editform optiontable" border="0" style="width:40%; text-align:center;" align="center">
				<tbody>
					<tr valign="top" >
						<th><label for="search_comments">Comments</label>
						<input type="checkbox" id="search_comments" name="search_comments" value="true" 
					<?php if ($devOptions['search_comments'] == "true") 
						{ _e('checked="checked"', "SphinxSearch"); }?>/></th>
					
					
						<th ><label for="search_posts">Posts</label>
						<input type="checkbox" id="search_posts" name="search_posts" value="true" 
					<?php if ($devOptions['search_posts'] == "true") 
						{ _e('checked="checked"', "SphinxSearch"); }?>/></th>
					
						<th ><label for="search_pages">Pages</label>
						<input type="checkbox" id="search_pages" name="search_pages" value="true" 
					<?php if ($devOptions['search_pages'] == "true") 
						{ _e('checked="checked"', "SphinxSearch"); }?>/></th>
					</tr>
				</tbody>
			</table>
		</fieldset>		
		<div class="submit">
			<input type="submit" name="update_SphinxSearchSettings" 
						value="<?php _e('Update Settings', 'SphinxSearch') ?>" />
		</div>
	
		<fieldset class="options">
			<h3>Keyword wrapper settings</h3>
			<table class="editform optiontable" border="0" style="width:80%; text-align:center;" align="center">
				<tbody>
					<tr valign="top" >
						<th scope="row">Before keyword in text</th>
						<td class="admioptions"><input type="text" id="excerpt_before_match" name="excerpt_before_match" 
						value="<?php echo $devOptions['excerpt_before_match'];?>" /></td>
					</tr>
					<tr valign="top" >
						<th scope="row">After keyword in text</th>
						<td class="admioptions"><input type="text" id="excerpt_after_match" name="excerpt_after_match" 
						value="<?php echo $devOptions['excerpt_after_match'];?>" /> </td>
					</tr>
					<tr valign="top" >
						<th scope="row">Before keyword in title</th>
						<td class="admioptions"><input type="text" id="excerpt_before_match_title" name="excerpt_before_match_title" 
						value="<?php echo $devOptions['excerpt_before_match_title'];?>" /></td>
					</tr>
					<tr valign="top" >
						<th scope="row">After keyword in title</th>
						<td class="admioptions"><input type="text" id="excerpt_after_match_title" name="excerpt_after_match_title" 
						value="<?php echo $devOptions['excerpt_after_match_title'];?>" /></td>
					</tr>
					<tr valign="top" >
						<th scope="row">Snippet separator</th>
						<td class="admioptions"><input type="text" id="excerpt_chunk_separator" name="excerpt_chunk_separator"  
						value="<?php echo $devOptions['excerpt_chunk_separator'];?>" /></td>
					</tr>
					<tr valign="top" >
						<th scope="row">Snippet max length</th>
						<td class="admioptions"><input type="text" id="excerpt_limit" name="excerpt_limit" size="4"
						value="<?php echo $devOptions['excerpt_limit'];?>" /></td>
					</tr>
					<tr valign="top" >
						<th scope="row">Maximum number of words around keyword</th>
						<td class="admioptions"><input type="text" id="excerpt_around" name="excerpt_around" size="4"
						value="<?php echo $devOptions['excerpt_around'];?>" /> </td>
					</tr>
					
					<tr valign="top" >
						<th scope="row">Prefix before Comment title</th>
						<td class="admioptions"><input type="text" id="before_comment" name="before_comment" 
						value="<?php echo $devOptions['before_comment'];?>" /></td>
					</tr>					
					<tr valign="top" >
						<th scope="row">Prefix before Page title</th>
						<td class="admioptions"><input type="text" id="before_page" name="before_page" 
						value="<?php echo $devOptions['before_page'];?>" /> </td>
					</tr>
					<tr valign="top" >
						<th scope="row">Prefix before Post title</th>
						<td class="admioptions"><input type="text" id="before_post" name="before_post" 
						value="<?php echo $devOptions['before_post'];?>" /></td>
					</tr>
					
					<tr valign="top" >
						<th scope="row">List of phrases to cut from search results (one phrase per line)</th>
						<td class="admioptions"><textarea id="strip_tags" name="strip_tags" rows="10" cols="25"><?php echo $devOptions['strip_tags'];?></textarea></td>
					</tr>
					
					<tr valign="top" >
						<th scope="row">List of not censor phrases to cut from search statistics (one phrase per line)</th>
						<td class="admioptions"><textarea id="censor_words" name="censor_words" rows="10" cols="25"><?php echo $devOptions['censor_words'];?></textarea></td>
					</tr>
				</tbody>
			</table>
		</fieldset>

		<div class="submit">
			<input type="submit" name="update_SphinxSearchSettings" 
						value="<?php _e('Update Settings', 'SphinxSearch') ?>" />
		</div>
	
		<fieldset class="options">
			<h3>Sphinx —Åonfiguration</h3>
			<table class="editform optiontable" border="0" style="width:80%; text-align:center;" align="center">
				<tbody>
					<tr valign="top" >
						<th scope="row">Sphinx index name</th>
						<td class="admioptions"><input type="text" id="sphinx_index" name="sphinx_index" 
						value="<?php echo $devOptions['sphinx_index'];?>" /></td>
					</tr>					
					<tr valign="top" >
						<th scope="row">Sphinx port (default 3312)</th>
						<td class="admioptions"><input type="text" id="sphinx_port" name="sphinx_port"  size="4"
						value="<?php echo $devOptions['sphinx_port'];?>" /></td>
					</tr>
					
					<tr valign="top" >
						<th scope="row">Sphinx configuration file path</th>
						<td class="admioptions"><input type="text" id="sphinx_conf" name="sphinx_conf" size="30"
						value="<?php echo $devOptions['sphinx_conf'];?>" /> (<?php echo !file_exists($devOptions['sphinx_conf'])?'<font color="red">Not exists</font>':'<font color="green">Exists</font>';?>)</td>
					</tr>
					
					<tr valign="top" >
						<th scope="row">Sphinx searchd file path</th>
						<td class="admioptions"><input type="text" id="sphinx_searchd" name="sphinx_searchd" size="30"
						value="<?php echo $devOptions['sphinx_searchd'];?>" /> (<?php echo !file_exists($devOptions['sphinx_searchd'])?'<font color="red">Not exists</font>':'<font color="green">Exists</font>';?>)</td>
					</tr>
					
					<tr valign="top" >
						<th scope="row">Sphinx indexer file path</th>
						<td class="admioptions"><input type="text" id="sphinx_indexer" name="sphinx_indexer" size="30" 
						value="<?php echo $devOptions['sphinx_indexer'];?>" /> (<?php echo !file_exists($devOptions['sphinx_indexer'])?'<font color="red">Not exists</font>':'<font color="green">Exists</font>';?>)</td>
					</tr>
				</tbody>
			</table>
		</fieldset>
		
		<div class="submit">
			<input type="submit" name="update_SphinxSearchSettings" 
						value="<?php _e('Update settings', 'SphinxSearch') ?>" />
		</div>
		</form>
		
		<form method="post" action="<?php echo $_SERVER["REQUEST_URI"]; ?>">
			<fieldset class="options">
				<h3>Indexer</h3>
			</fieldset>
			<div class="submit">
				<input type="submit" style="width:300px;" name="reindex_sphinx" value="Run indexing manually" />
			</div>
		</form>		
		
		<form method="post" action="<?php echo $_SERVER["REQUEST_URI"]; ?>">
			<fieldset class="options">
				<h3>Search daemon</h3>
			</fieldset>
			<div class="submit">
				<?php if ($devOptions['sphinx_running'] == 'true'): ?>			
					<input type="submit" style="width:300px;" name="stop_sphinx" value="Stop Sphinx daemon" />
				<?php else: ?>			
					<input type="submit" style="width:300px;" name="start_sphinx" value="Start Sphinx daemon" />
				<?php endif; ?>
			</div>
		</form>	
		
		<form method="post" action="<?php echo $_SERVER["REQUEST_URI"]; ?>" target="_blank">
			<fieldset class="options">
				<h3>Sphinx Search daemon installation</h3>
			</fieldset>
                        <strong>
			<?php if ($devOptions['sphinx_installed'] == 'true'): ?>
                            <p>Sphinx already installed in: <?php echo $devOptions['sphinx_path']; ?></p>
                            <p>You can re-install your personal Sphinx search engine in <?php echo SPHINXSEARCH_SPHINX_INSTALL_DIR; ?> directory of your blog.</p>
			<?php else:?>
                            <p>Sphinx is not installed.</p>
                            <p>You can install your personal Sphinx search engine in <?php echo SPHINXSEARCH_SPHINX_INSTALL_DIR; ?> directory of your blog.</p>
			<?php endif; ?>
                        </strong>
			
			<p><strong>It may take a few minutes.</strong></p>
			<div class="submit">
				<?php if ($devOptions['sphinx_installed'] == 'true'): ?>
					<input type="submit" style="width:300px;" name="install_sphinx" value="Reinstall personal Sphinx search engine" onclick="if (confirm('Are you sure you want to reinstall Sphinx search engine?\nAll previouse installation files will be removed!') ) return true;  else return false;" />
				<?php else:?>
					<input type="submit" style="width:300px;" name="install_sphinx" value="Install personal Sphinx search engine" onclick="if (confirm('Are you sure you want to install Sphinx search engine?') ) return true;  else return false;" />
				<?php endif; ?>
			</div>
		</form>
		
 	</div>
